% \documentclass[newzealand,10pt,partial,draft,onehalfspace]{aucklandthesis}
% \documentclass[newzealand,10pt,partial,onehalfspace]{aucklandthesis}
\documentclass[newzealand,10pt,partial,onehalfspace,examcopy,final]{aucklandthesis}

\makeatletter
\renewcommand\@pnumwidth{0.77cm}
\makeatother

%
% This is a template for University of Auckland theses.
%
% Written by Alistair Kwan, June 2016
% 
%
% Options:
%	10pt, 11pt, 12pt: size of main text
% 	examcopy: asserts confidentiality for examination copies
%	partial: thesis partial fulfils degree requirements
%	singlespace, onehalfspace, doublespace: line spacing
%	oneside: format for single-sided printing
%	draft: adds 'draft' and date to footer
%

% \usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}

%%%% Packages introduced by me, not included with the template

\usepackage{babel}
\usepackage[UKenglish,abbreviations,xfrench,xlatin]{foreign}

\usepackage[normalem]{ulem}
\usepackage{amsmath,amssymb,cpsystems,nmp,url,xcolor}
\usepackage{subcaption}
\usepackage{listings,minted,alltt,pdfpages}

\lstset{frame=single}
\lstset{mathescape=true,escapechar=\#}
\lstset{showstringspaces=false}
\lstset{basicstyle=\small}

\usepackage{csquotes}
\usepackage[defblank]{paralist}

\usepackage{siunitx}
% \usepackage{threeparttable} % look at removing this --- it was only introduced to make the G Col Rep stuff build
\usepackage{fixme}
\fxusetheme{color}

\usepackage[altpo]{backnaur}

% Introduced to make the NMP paper stuff build
\usepackage[ruled,vlined,linesnumbered,nofillcomment]{algorithm2e}

\usepackage{morewrites}
\usepackage{amsthm}
\theoremstyle{plain}

\newcommand{\listingautorefname}{Listing}
%
% Add, delete or un-comment packages below as required.
%

% Readability options
%
% \usepackage{booktabs} % for table rules
\usepackage{microtype} % for improved justification

\usepackage{graphicx} % for inserting graphics files
\usepackage{appendix} % for appendices

\usepackage{pgfplots}
\pgfplotsset{compat=1.17}
\usepgfplotslibrary{external,groupplots}

% The below was taken from https://tex.stackexchange.com/a/82224 to get rid of some warnings with pgfplots when running in draft mode
\pgfkeys{/pgf/images/include external/.code=\includegraphics{#1}}

\tikzexternalize[optimize command away=\includepdf]

% Typeface options â€” choose one if desired
% or choose a different typeface to accommmodate character sets
% as needed for East Asian and other languages.
%
% Consider compiling using the XeLaTeX engine if you have more extreme
% typeface needs, e.g. for multiple languages, or a need for symbols particular
% to a typeface.
%
% See also the LaTeX Symbols List at
% https://http://www.ctan.org/pkg/comprehensive
%
% \usepackage{mathptmx} % Times New Roman, including mathematics
% \usepackage{mathpazo} % Palatino with mathematics support
% \usepackage{fourier} % Utopia, a serif typeface with Fourier mathematics
% \usepackage{gentium} % a contemporary serif typeface
% \usepackage{libertine} % a softer-feeling serif typeface; also installs sans-serif font Biolinum
% \usepackage{fouriernc} % Century Schoolbook with Fourier maths
% \usepackage{mathpple} % Palatino with Fourier maths


% To set the sans serif font (for \sffamily):
% \usepackage[scaled]{helvet} % Nimbus, like Helvetica
% \usepackage{universalis} % Universalis
% \usepackage{avant} % URW Gothic, like Avant Garde
% \usepackage{PTSansNarrow}
% \usepackage{AlegreyaSans} % Alegreya Sans

% To set the mathematics font:
% \usepackage{eulervm} % Euler, based on a Zapf design

% To set the (usually monospaced) typewriter font:
% \usepackage[ttdefault=true]{AnonymousPro}
% \usepackage[scaled]{beramono}
% \usepackage{inconsolata}
% \usepackage{sourcecodepro}

%\usepackage{cjk} % for Chinese, Japanese, Korean

\usepackage{tabularx} % For easier table formatting.

% \usepackage[nottoc]{tocbibind} % Controls the table of contents
%   nottoc: don't list table of contents inside itself
%   section: go as far as section-level headings

% Automated bibliography
%
\usepackage[
	bibstyle=ieee, 
%	citestyle=numeric-comp,
    citestyle=ieee,
	backend=biber,
	sorting=nyt,
	sortcites,
% 	backref,
	dashed=false,
	urldate=long,
	]
	{biblatex}
	\addbibresource{bib/stereo.bib}
	\addbibresource{bib/compmodels.bib}
	\addbibresource{bib/psystems.bib}
	\addbibresource{bib/languages.bib}
	\addbibresource{bib/medianfilter.bib}
	\addbibresource{bib/tsp.bib}
	\addbibresource{bib/g-col.bib}
	\addbibresource{bib/nmp.bib}

% The below was copied verbatim from https://tex.stackexchange.com/a/154875 on 9 December 2019, and then modified to reverse the ordering of the URL and DOI fields.  The purpose of it is to suppress the use of the URL field if the DOI field is defined - thus avoiding the many instances where the URL is printed, but is just a link to the DOI (besides which, in the PDF the DOI becomes a link to the DOI site).  It seems to work for my purposes.
\DeclareSourcemap{
  \maps[datatype=bibtex]{
    \map{
      \step[fieldsource=doi,final]
      \step[fieldset=url,null]
    } 
  }
}

\usepackage[nospace]{varioref}
\usepackage[hidelinks]{hyperref} % for formatting web addresses and other URLs
\urlstyle{same} % try also tt, sf if this option doesn't produce clear enough output

\usepackage[capitalise]{cleveref} % Placed after hyperref in accordance with the documentation

%%% All the glossaries stuff was put here, since the Glossaries documentation says it should be used after hyperref.

\usepackage[acronym]{glossaries-extra}
\setabbreviationstyle[acronym]{long-short}
\makeglossaries

\input{tex/newcommands} % Miscellaneous commands I made for use in this dissertation

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\loadglsentries{tex/glossary}

\begin{document}
\frontmatter

% ====================================================
%
% FRONTMATTER
%
% Arabic pagination, starting with the title page
% which is counted but not numbered
%
% ====================================================
% Specify the title page content
\title{Highly Concurrent Solutions to Graph and Image Processing Problems}
\subtitle{{\small v0.5.0 compiled on \today}}
\author{James Cooper}
\degreesought{Doctor of Philosophy} 
\degreediscipline{Computer Science}
\degreecompletionyear{2021}

\pagenumbering{gobble}
% Print the title page
\maketitle
% \frontmatter
\pagenumbering{roman}

% Abstract, up to 350 words
\include{tex/abstract} % it's in a separate file

% Dedication (optional)
% \thesisdedication{Dedicated to grandma, and to grammar.}
% \thesisdedication{This work is dedicated to the interested reader and all those who make use of material presented within.}

% Preface and/or acknowledgements (optional)
\input{tex/acknowledgements.tex} % it's in a separate file

% Contents, lists of tables and figures
\settocdepth{subsection} % choose chapter, section, subsection 
\cleardoublepage\tableofcontents
\cleardoublepage\listoffixmes
\cleardoublepage\listoffigures
\cleardoublepage\listoftables
\cleardoublepage\listofcprulesetfloats
\cleardoublepage\listofcpobjectsfloats
\cleardoublepage\printglossary
\cleardoublepage\printglossary[type=\acronymtype]

\includepdf{coauthorship_forms/coauthorship_form_HPP_TSP_signed.pdf}
\includepdf{coauthorship_forms/coauthorship_form_GCOL_signed.pdf}
\includepdf{coauthorship_forms/co_authorship_form_cp_systems_stats_signed.pdf}
\includepdf{coauthorship_forms/co_authorship_form_nmp_signed.pdf}

% ====================================================
%
% MAINMATTER
%
% Include external chapter files here using
% the \input{} command
%
% If you run out of memory during compilation,
% switch some or all chapters to \include{} instead of \input{}, 
% but watch out for pagination problems.
%
% ====================================================

% \mainmatter

% The below is direct from https://tex.stackexchange.com/a/615994/113430
\mainmatter
\makeatletter
\@mainmattertrue
\makeatother
\setcounter{secnumdepth}{\value{maxsecnumdepth}}

\counterwithin{figure}{chapter}
\counterwithin{table}{chapter}

\begin{anfxwarning}{Extra glossary entries?}
Include definitions of promoter and inhibitor in the glossary?
\begin{itemize}
    \item promoter
    \item inhibitor
    \item antiport
\end{itemize}
\end{anfxwarning}

\glsresetall
\include{tex/intro}
\glsresetall
\include{chapters/background/background}
\glsresetall
\include{chapters/cpsystems/cpsystems}
\glsresetall
\include{chapters/tsp/tsp}
\glsresetall
\include{chapters/gcol/g-col-rep}
\glsresetall
\include{chapters/medianfilter/median}
\glsresetall
\include{chapters/nmp/nmp}
\glsresetall
\include{tex/conclusion}

% ====================================================
%
% ENDMATTER
%
% Appendices and bibliography 
% Pagination arabic, re-starts at 1
%
% ====================================================

\backmatter

\cleardoublepage % start afresh on a new page

% \appendixpage* % makes a page to mark beginning of appendices -- currently there are no appendices
% \input{appendix1}

\printbibliography[title={Works Cited}, heading=bibintoc]

\end{document}